<!DOCTYPE html><html lang="en" data-theme="light"><head><head> <!-- Include Meta Tags Here --><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta content='#000000' name='theme-color'/><meta name="keywords" content="Site, Template, Theme"><title>Solais Security Solutions | Setting Up Git Commit Signing with Multiple YubiKeys</title><link rel="canonical" href="https://solaissecurity.com/blog/yubikey-setup-commit-signing"> <!-- Open Graph general (Facebook, Pinterest & Google+) --><meta property="og:title" content="Solais Security Solutions | Setting Up Git Commit Signing with Multiple YubiKeys"><meta property="og:description" content="Guide on how to set up git commit signing with multiple YubiKeys, including hardware attestation to prove keys were generated on-device with specific touch policy."><meta property="og:image" content="https://solaissecurity.com/assets/images/blog/commit-signing.png"><meta property="og:image:alt" content="Solais Security Solutions | Setting Up Git Commit Signing with Multiple YubiKeys"><meta property="og:url" content="https://solaissecurity.com/blog/yubikey-setup-commit-signing"><meta property="og:site_name" content="Solais Security Solutions"><meta property="og:type" content="article"> <!-- Twitter --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Solais Security Solutions | Setting Up Git Commit Signing with Multiple YubiKeys"><meta name="twitter:description" content="Guide on how to set up git commit signing with multiple YubiKeys, including hardware attestation to prove keys were generated on-device with specific touch policy."><meta name="twitter:image" content="https://solaissecurity.com/assets/images/blog/commit-signing.png"> <!-- Search Engine --><meta name="description" content="Guide on how to set up git commit signing with multiple YubiKeys, including hardware attestation to prove keys were generated on-device with specific touch policy."><meta name="image" content="https://solaissecurity.com/assets/images/blog/commit-signing.png"> <!-- Schema.org for Google --><meta itemprop="name" content="Solais Security Solutions | Setting Up Git Commit Signing with Multiple YubiKeys"><meta name="author" content="Kevin Quill"><meta itemprop="description" content="Guide on how to set up git commit signing with multiple YubiKeys, including hardware attestation to prove keys were generated on-device with specific touch policy."><meta itemprop="image" content="https://solaissecurity.com/assets/images/blog/commit-signing.png"><title>Solais Security Solutions</title><link rel="stylesheet" href="/assets/css/style.css"> <script src="https://kit.fontawesome.com/f5a7c7110b.js" crossorigin="anonymous"></script> <!--<link rel="shortcut icon" href="' | absolute_url }}" type="image/x-icon"> --> <!-- Favicon: default / light mode --><link rel="icon" type="image/png" sizes="16x16" href="https://solaissecurity.com/assets/images/favicons/light-favicon-16.png?v=3"><link rel="icon" type="image/png" sizes="32x32" href="https://solaissecurity.com/assets/images/favicons/light-favicon-32.png?v=3"><link rel="icon" type="image/png" sizes="48x48" href="https://solaissecurity.com/assets/images/favicons/light-favicon-48.png?v=3"><link rel="icon" type="image/png" sizes="96x96" href="https://solaissecurity.com/assets/images/favicons/light-favicon-96.png?v=3"><link rel="icon" type="image/png" sizes="192x192" href="https://solaissecurity.com/assets/images/favicons/light-favicon-192.png?v=3"><link rel="icon" type="image/png" sizes="512x512" href="https://solaissecurity.com/assets/images/favicons/light-favicon-512.png?v=3"><link rel="shortcut icon" href="https://solaissecurity.com/assets/images/favicons/light-favicon.ico?v=3"> <!-- Apple Touch Icon --><link rel="apple-touch-icon" sizes="180x180" href="https://solaissecurity.com/assets/images/favicons/dark-apple-touch-icon.png?v=3"> <!-- Dark mode icons --><link rel="icon" type="image/png" sizes="16x16" href="https://solaissecurity.com/assets/images/favicons/dark-favicon-16.png?v=3" media="(prefers-color-scheme: dark)"><link rel="icon" type="image/png" sizes="32x32" href="https://solaissecurity.com/assets/images/favicons/dark-favicon-32.png?v=3" media="(prefers-color-scheme: dark)"><link rel="icon" type="image/png" sizes="48x48" href="https://solaissecurity.com/assets/images/favicons/dark-favicon-48.png?v=3" media="(prefers-color-scheme: dark)"><link rel="icon" type="image/png" sizes="96x96" href="https://solaissecurity.com/assets/images/favicons/dark-favicon-96.png?v=3" media="(prefers-color-scheme: dark)"><link rel="icon" type="image/png" sizes="192x192" href="https://solaissecurity.com/assets/images/favicons/dark-favicon-192.png?v=3" media="(prefers-color-scheme: dark)"><link rel="icon" type="image/png" sizes="512x512" href="https://solaissecurity.com/assets/images/favicons/dark-favicon-512.png?v=3" media="(prefers-color-scheme: dark)"><link rel="shortcut icon" href="https://solaissecurity.com/assets/images/favicons/dark-favicon.ico?v=3" media="(prefers-color-scheme: dark)"> <!-- Optional: Safari / iOS prefers Apple Touch Icon automatically --><link rel="apple-touch-icon" sizes="180x180" href="https://solaissecurity.com/assets/images/favicons/light-apple-touch-icon.png?v=3" media="(prefers-color-scheme: light)"><meta name="google-site-verification" content="fQzaBNUGPJYJiCBtHtchqgSngH3hglzEB_7QcNLeNBE" /> <script src="https://cdn.counter.dev/script.js" data-id="16e4d60c-cadd-4633-9289-e43d0d61fa63" data-utcoffset="0"></script> <script src="/assets/js/navbar.js"></script></head></head><body><nav class="navbar is-primary is-fixed-top" role="navigation" aria-label="main navigation" data-theme="dark" id="navbar"> <!-- logo or branding image on left side --><div class="navbar-brand"> <a class="navbar-item" href="https://solaissecurity.com/"> <img src="https://solaissecurity.com/assets/images/header_logo.png" alt="Logo" style="max-height: 50px;"> </a> <a class="navbar-burger" role="button" aria-label="menu" aria-expanded="false" data-target="navMenu"> <span aria-hidden="true"></span> <span aria-hidden="true"></span> <span aria-hidden="true"></span> <span aria-hidden="true"></span> </a></div><!-- children of navbar-menu must be navbar-start and/or navbar-end --><div class="navbar-menu" id="navMenu"><div class="navbar-start"> <!-- navbar items --></div><div class="navbar-end"> <a class="navbar-item" href="https://solaissecurity.com/#services">SERVICES</a> <a class="navbar-item" href="https://solaissecurity.com/#about">ABOUT</a> <a class="navbar-item" href="https://solaissecurity.com/#contact">CONTACT</a> <a class="navbar-item " href="https://solaissecurity.com/blog">BLOG </a><div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link"> MORE </a><div class="navbar-dropdown is-right"> <a href="https://solaissecurity.com/baseline-assessment/" class="navbar-item is-link "> Baseline Security Assessment </a> <a href="https://solaissecurity.com/security-strategy/" class="navbar-item is-link "> Security Strategy Development </a> <a href="https://solaissecurity.com/control-implementation/" class="navbar-item is-link "> Control Design & Implementation </a> <a href="https://solaissecurity.com/general-consultancy/" class="navbar-item is-link "> Expert at Hand </a> <a href="https://solaissecurity.com/security-review/" class="navbar-item is-link "> Technical Security Review </a> <!--<hr class="navbar-divider"> <a class="navbar-item"> Report an issue </a> --></div></div></div></div></nav><!-- Bulma Navbar JS --> <script> document.addEventListener('DOMContentLoaded', ()=> { /* Get all "navbar-burger" elements */ var $navbarBurgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'), 0); /* Check if there are any navbar burgers */ if ($navbarBurgers.length > 0) { /* Add a click event on each of them */ $navbarBurgers.forEach(el => { el.addEventListener('click', function () { /* Get the target from the "data-target" attribute */ var target = el.dataset.target; var $target = document.getElementById(target); /* Toggle the class on both the "navbar-burger" and the "navbar-menu" */ el.classList.toggle('is-active'); $target.classList.toggle('is-active'); }); }); } }); </script><section class="hero is-fullheight has-text-centered" id="post"><div class="hero-body"><div class="container"> <a href="/blog/yubikey-setup-commit-signing" class="has-text-black" id="title"><h1 class="title has-text-centered is-2 has-text-weight-semibold ">Setting Up Git Commit Signing with Multiple YubiKeys</h1></a><hr class="has-background-black"><div class="columns is-variable is-5"><div class="column is-6"><figure class="image is-16by9 has-shadow"> <img src="https://solaissecurity.com/assets/images/blog/commit-signing.png" alt="" id="post-image"></figure></div><div class="subtitle column is-5 has-text-left-desktop has-text-left-fullhd has-text-left-tablet has-text-center-mobile"><p id="description" class="content is-small has-text-weight-medium is-uppercase">Guide on how to set up git commit signing with multiple YubiKeys, including hardware attestation to prove keys were generated on-device with specific touch policy.</p><p class="subtitle is-6 is-uppercase has-text-weight-normal has-text-black-ter">Published on <b>November 30, 2025</b> by <a href="https://github.com/kvql" target="_blank"><b class="has-text-link"><u>Kevin Quill</u></b> </a></p><p class="subtitle is-uppercase"> <i class="fas fa-tags"></i> <span class="tag is-link">post</span> <span class="tag is-link">security-engineering</span> <span class="tag is-link">yubikey</span> <span class="tag is-link">pgp</span> <span class="tag is-link">supply-chain-security</span> <span class="tag is-link">git</span> <span class="tag is-link">how-to-guide</span> <span class="tag is-link">code signing</span></p><p class="subtitle is-uppercase"><i class="fas fa-clock"></i> <b class="has-text-link"> 15 min </b>READ</p></div></div><div class="content has-text-justified-desktop has-text-justified-fullhd has-text-justified has-text-justified-tablet has-text-left-mobile"><h1 id="setting-up-git-commit-signing-with-multiple-yubikeys">Setting Up Git Commit Signing with Multiple YubiKeys</h1><p>This guide demonstrates how to set up git commit signing using multiple YubiKeys. It covers the complete workflow from initial setup through attestation, addressing gaps in existing documentation around multiple signing subkeys and attestation for code signing.</p><h2 id="what-youll-build">What You’ll Build</h2><p>By the end of this guide, you’ll have:</p><ul><li>Multiple Yubikeys configured for git commit signing with a primary key and device-specific subkeys</li><li>A bash function to simplify switching between different Yubikeys</li><li>Touch policy enforcement requiring physical key tap for each signing operation</li><li>Properly configured git to sign commits with the currently inserted key</li><li>Optional: Cryptographic attestation proving keys were generated on hardware and enforce touch policy</li></ul><h2 id="motivation">Motivation</h2><p>Coming at this from the perspective of publishing open-source tooling and having been a user of open source tooling for critical production use cases. I wanted to give users with high-risk threat models the best option for validating my signing practices and code integrity.</p><blockquote><p><strong>Multiple YubiKeys</strong><br /> Having multiple YubiKeys in different form factors, I couldn’t guarantee I would always have the same key at hand. Therefore I wanted a seamless way to sign code with different keys without impacting the ability for users of my code to verify it. The developer experience for me is also a primary requirement alongside security and whatever the setup looks like it shouldn’t make the process any more inconvenient for me than using a single YubiKey.</p></blockquote><h2 id="technology-used">Technology Used</h2><ul><li>macOS Tahoe</li><li>Yubikey 5 (multiple form factors)`</li><li>Github</li></ul><h2 id="prerequisites">Prerequisites</h2><p>Before starting, ensure you have the following tools installed:</p><blockquote><p>Below is an example install of required tooling, but isn’t a comprehensive guide across platforms as that is well covered in information online.</p></blockquote><p><strong>Required Tools:</strong></p><ul><li><strong>GnuPG (gpg)</strong></li><li><strong>pinentry-mac</strong></li><li><strong>YubiKey Manager (ykman)</strong> - Latest version recommended</li><li>One or more Yubikey devices</li></ul><p><strong>Installation (macOS):</strong></p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Install via Homebrew</span>
brew <span class="nb">install </span>gnupg ykman pinentry-mac

<span class="c"># Verify installation</span>
gpg <span class="nt">--version</span>
ykman <span class="nt">--version</span>

<span class="c"># Setup Pinentry</span>
<span class="nb">echo</span> <span class="s2">"pinentry-program </span><span class="si">$(</span>brew <span class="nt">--prefix</span><span class="si">)</span><span class="s2">/bin/pinentry-mac"</span> <span class="o">&gt;</span> ~/.gnupg/gpg-agent.conf    

</code></pre></div></div><p><strong>Other Platforms:</strong> See <a href="https://gnupg.org/download/">GnuPG Downloads</a> and <a href="https://www.yubico.com/support/download/yubikey-manager/">YubiKey Manager Installation</a></p><h2 id="process-overview">Process Overview</h2><p>This guide follows a structured workflow:</p><ol><li><strong>Yubikey Initial Setup</strong> - Configure security settings, PINs, and key attributes on your first Yubikey</li><li><strong>Key Generation</strong> - Create the primary key and signing subkeys<ul><li>Generate primary key</li><li>Set up additional Yubikeys with their own signing subkeys</li></ul></li><li><strong>Touch Policy Configuration</strong> - Require physical touch for signing operations</li><li><strong>Git Integration</strong> - Configure git to use your Yubikey for commit signing</li><li><strong>Testing Your Setup</strong> - Verify everything works correctly</li><li><strong>Verifying Signatures</strong> - Learn how others can verify your signed commits</li><li><strong>[Optional] Attestation</strong> - Generate cryptographic proof of hardware key generation</li></ol><h2 id="part-1-yubikey-initial-setup">Part 1: Yubikey Initial Setup</h2><p>First time setups tasks based on this <a href="https://github.com/YubicoLabs/sign-git-commits-yubikey">Yubico Guide</a> and a <a href="https://www.procustodibus.com/blog/2023/04/how-to-set-up-a-yubikey/">blog</a> which I found particularly comprehensive. <strong><em>Before following these steps, see the mentioned guides on installing tooling.</em></strong></p><ol><li>Set Fido pin (unrelated to signing but useful)</li><li>Set lock-code to prevent the yubikey being wiped</li><li>Change pgp pin and admin pin (no need to set reset code, this is for when use doesn’t know admin pin e.g. set by IT)</li><li>Set key attributes (ecc and curve 25519)</li><li>Set retry limits: <code class="language-plaintext highlighter-rouge">ykman openpgp access set-retries 9 9 9</code></li></ol><blockquote><p><strong>Compatibility issue:</strong><br /> The Yubico Labs guide mentions using RSA4096 however that isn’t supported on firmware &lt; 5.7.0</p></blockquote><p>General list of commands but see the linked guides for more detail if unfamiliar with PGP and Yubikey manager</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c"># Set Fido pin</span>
ykman fido access change-pin

<span class="c"># password protect the yubikey config. Remember to save this code or your yubikey may become useless</span>
ykman config set-lock-code <span class="nt">--generate</span>

<span class="c"># Pins can be set with with gpg or ykman apps</span>
<span class="c"># Pin defaults: </span>
gpg <span class="nt">--card-edit</span>
admin
passwd

<span class="c"># see output for instructions</span>
ykman openpgp access <span class="nt">-h</span>

<span class="c"># Set lockout counts</span>
ykman openpgp access set-retries 9 9 9 

<span class="c"># Set default key attributes (cipher and length/algorithm)</span>
gpg <span class="nt">--card-edit</span> <span class="c">#starts interactive prompt</span>
admin
key-attr
<span class="c">#... selection</span>
quit
</code></pre></div></div><blockquote><p><strong>Pin Recommendations:</strong><br /> Pin can be 8 to 127 chars, passphrase is best practice. Due to low retry limits complexity doesn’t need to be as high as online passwords</p></blockquote><h3 id="verifying-your-setup">Verifying Your Setup</h3><p>After completing the initial setup, verify your Yubikey is properly configured:</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check Yubikey is detected and OpenPGP app is accessible</span>
gpg <span class="nt">--card-status</span>

<span class="c"># Expected output should show:</span>
<span class="c"># - PIN retry counters (should show 9 9 9 if you set them)</span>
<span class="c"># - Key attributes showing your chosen algorithm (e.g., ed25519)</span>
</code></pre></div></div><p><strong>What to look for:</strong></p><ul><li>Reader status shows your Yubikey serial number</li><li>PIN retry counter shows your configured values (9 9 9)</li><li>Key attributes match what you set (ECC, Curve 25519)</li></ul><p>If <code class="language-plaintext highlighter-rouge">gpg --card-status</code> fails or shows unexpected values, review the setup steps before proceeding to key generation.</p><h2 id="part-2-key-generation">Part 2: Key Generation</h2><h3 id="primary-key">Primary Key</h3><p>In OpenPGP, keys have specific capabilities: <strong>[C]</strong>ertify (primary key), <strong>[S]</strong>ign, <strong>[E]</strong>ncrypt, and <strong>[A]</strong>uthenticate. For commit signing, you’ll create a primary key with certify capability and one or more signing subkeys with the sign capability.</p><p>The <a href="https://github.com/YubicoLabs/sign-git-commits-yubikey">Yubico Guide</a> can be followed for this step.</p><blockquote><p><strong>Primary Yubikey</strong> With PGP the primary certifying key is higher risk as it can certify other subkeys, therefore while it’s call the primary key, it shouldn’t be on your “primary yubikey” that you intend to use daily. Keep it on a backup YubiKey.</p></blockquote><p><strong>Commands overview:</strong></p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gpg <span class="nt">--card-edit</span>
admin
generate
<span class="c"># follow prompts and see notes below</span>

<span class="c">#exit gpg interactive prompt</span>
quit

<span class="c"># View new key</span>
gpg <span class="nt">--list-secret-keys</span> <span class="nt">--keyid-format</span><span class="o">=</span>long
</code></pre></div></div><p><strong>Notes:</strong></p><ul><li><strong>[User ID Properties]</strong> Think about privacy when it comes to real name and email fields, the public key is public when uploaded to Github (<a href="https://github.com/username.gpg">https://github.com/username.gpg</a>). e.g utilise <a href="https://docs.github.com/en/authentication/managing-commit-signature-verification/generating-a-new-gpg-key#generating-a-gpg-key">Github no-reply email</a></li><li><strong>[Private key export]</strong> The private key for the master key can be exported (subkeys cannot be exported), for purely signing use cases, I don’t believe it is worth the security overhead of securing backup key. Worst case you will need to regenerate the keys and publish a new key but that is no worse than most current best practice that recommends utilising ssh based signing.</li><li><strong>[Public key]</strong> The public key isn’t stored on the yubikey with the primary secret key, therefore you should export and backup the public key after any key changes.<ul><li>Importing the public key to gpg agent is required to perform any key modifications or use the keys for signing (e.g on a new laptop)</li></ul></li></ul><h3 id="setting-up-secondary-yubikeys">Setting Up Secondary Yubikeys</h3><p>Once your primary key is configured, you can generate subkeys on additional Yubikeys for daily use and to provide redundancy.</p><p><strong>Process for each additional Yubikey:</strong></p><ol><li><p>Complete Part 1 (Initial Setup) on the new Yubikey - set PINs, lock code, and key attributes</p></li><li><p>Insert the new Yubikey and generate a new signing subkey linked to your primary key:</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># (Should already be there unless on new device)Import your public key</span>
gpg <span class="nt">--import</span> /path/to/your/public-key.asc

<span class="c"># Edit the key to add a new signing subkey</span>
gpg <span class="nt">--edit-key</span> YOUR_KEY_ID
<span class="c"># At the gpg&gt; prompt:</span>
addcardkey
<span class="c"># Select (1) Signature key</span>
<span class="c"># Follow prompts to generate the subkey on the new Yubikey</span>
save
</code></pre></div></div></li><li><p>Export and backup your updated public key:</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gpg <span class="nt">--armor</span> <span class="nt">--export</span> YOUR_KEY_ID <span class="o">&gt;</span> updated-public-key.asc
</code></pre></div></div></li><li><p>Upload the updated public key to GitHub or your key server</p></li><li><p>Set the touch policy on the new subkey (see Part 3)</p></li></ol><p><strong>Important:</strong> Each Yubikey will have its own unique signing subkey, but all are certified by the same primary key. This means users only need to import your public key once to verify signatures from any of your Yubikeys.</p><h2 id="part-3-setting-the-touch-policy">Part 3: Setting the Touch Policy</h2><p>Following generation of the keys, you need to set the touch policy for the key so as it needs to be touched to complete a signing request.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ykman openpgp keys set-touch sig cached-fixed
</code></pre></div></div><blockquote><p><strong>Touch Policy Choice</strong> I believe the cached-fixed policy offers most pragmatic choice as it limits the exposure window but doesn’t prevent you from performing actions like rebases which otherwise would require constant tapping of the key.</p></blockquote><p><strong>Verifying Touch Policy:</strong></p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check current touch policy settings</span>
ykman openpgp info

<span class="c"># Look for "Touch policy" under signature key section</span>
<span class="c"># Should show: sig cached-fixed</span>
</code></pre></div></div><p>You can also test this works by attempting a test signature - you should need to touch the key to complete the operation.</p><h2 id="part-4-git-integration">Part 4: Git Integration</h2><p>Git will select the newest signing key in the public key, it does not have any logic to detect which Yubikey is available. For multiple Yubikeys, you have two approaches:</p><h3 id="option-1-manual-configuration">Option 1: Manual Configuration</h3><p>Manually specify which subkey to use by appending <code class="language-plaintext highlighter-rouge">!</code> to the key ID:</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Get your subkey IDs</span>
gpg <span class="nt">--list-keys</span> <span class="nt">--keyid-format</span><span class="o">=</span>long

<span class="c"># Configure git to use a specific subkey (use the subkey ID, not the primary key)</span>
git config <span class="nt">--global</span> user.signingKey C5CA48564B2395E5!
</code></pre></div></div><p>You’ll need to run this command each time you switch Yubikeys.</p><h3 id="option-2-automated-key-switching-recommended">Option 2: Automated Key Switching (Recommended)</h3><p>Use this bash function to automatically detect and configure the correct subkey:</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yk-git-key<span class="o">()</span> <span class="o">{</span>
    <span class="nb">echo</span> <span class="s2">"YubiKeys detected:"</span>
    <span class="nb">local </span>ykman_output
    <span class="nv">ykman_output</span><span class="o">=</span><span class="si">$(</span>ykman list 2&gt;&amp;1<span class="si">)</span>
    <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$ykman_output</span><span class="s2">"</span>

    <span class="k">if</span> <span class="o">[[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="nv">$ykman_output</span><span class="s2">"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"---"</span>
        <span class="nb">echo</span> <span class="s2">"ERROR: No YubiKey detected"</span> <span class="o">&gt;</span>&amp;2
        <span class="k">return </span>1
    <span class="k">fi
    </span><span class="nb">echo</span> <span class="s2">"---"</span>

    <span class="c"># Get Application ID</span>
    <span class="nb">local </span>AppID
    <span class="nv">AppID</span><span class="o">=</span><span class="si">$(</span>gpg <span class="nt">--card-status</span> 2&gt;/dev/null | <span class="nb">grep</span> <span class="s2">"Application ID"</span> | <span class="nb">awk</span> <span class="s1">'{print $4}'</span> | <span class="nb">tr</span> <span class="nt">-d</span> <span class="s1">'\n\r'</span><span class="si">)</span>

    <span class="k">if</span> <span class="o">[[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="nv">$AppID</span><span class="s2">"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"ERROR: No YubiKey detected or OpenPGP app not configured"</span> <span class="o">&gt;</span>&amp;2
        <span class="nb">echo</span> <span class="s2">"Try: gpg --card-status"</span> <span class="o">&gt;</span>&amp;2
        <span class="k">return </span>1
    <span class="k">fi
    </span><span class="nb">echo</span> <span class="s2">"Device AppID: </span><span class="nv">$AppID</span><span class="s2">"</span>

    <span class="c"># Validate AppID format</span>
    <span class="k">if</span> <span class="o">[[</span> <span class="o">!</span> <span class="nv">$AppID</span> <span class="o">=</span>~ ^D[A-F0-9]<span class="o">{</span>31<span class="o">}</span><span class="nv">$ </span><span class="o">]]</span><span class="p">;</span> <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"ERROR: Invalid Application ID format: </span><span class="nv">$AppID</span><span class="s2">"</span> <span class="o">&gt;</span>&amp;2
        <span class="k">return </span>1
    <span class="k">fi</span>

    <span class="c"># Find matching signing key</span>
    <span class="nb">local </span>KeyID
    <span class="nv">KeyID</span><span class="o">=</span><span class="si">$(</span>gpg <span class="nt">--list-secret-keys</span> <span class="nt">--with-colons</span> | <span class="nb">grep</span> <span class="s2">"</span><span class="nv">$AppID</span><span class="s2">"</span> | <span class="nb">awk</span> <span class="nt">-F</span><span class="s1">':'</span> <span class="s1">'{print $5}'</span> | <span class="nb">tr</span> <span class="nt">-d</span> <span class="s1">'\n\r'</span><span class="si">)</span>

    <span class="k">if</span> <span class="o">[[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="nv">$KeyID</span><span class="s2">"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"ERROR: No signing subkey found for this YubiKey"</span> <span class="o">&gt;</span>&amp;2
        <span class="nb">echo</span> <span class="s2">"Ensure public key is imported: gpg --import public-key.asc"</span> <span class="o">&gt;</span>&amp;2
        <span class="k">return </span>1
    <span class="k">fi
    </span><span class="nb">echo</span> <span class="s2">"Signing Key ID: </span><span class="nv">$KeyID</span><span class="s2">"</span>

    <span class="c"># Validate KeyID format</span>
    <span class="k">if</span> <span class="o">[[</span> <span class="o">!</span> <span class="nv">$KeyID</span> <span class="o">=</span>~ ^[A-F0-9]<span class="o">{</span>16<span class="o">}</span><span class="nv">$ </span><span class="o">]]</span><span class="p">;</span> <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"ERROR: Invalid Key ID format: </span><span class="nv">$KeyID</span><span class="s2">"</span> <span class="o">&gt;</span>&amp;2
        <span class="k">return </span>1
    <span class="k">fi</span>

    <span class="c"># Configure git</span>
    <span class="k">if</span> <span class="o">!</span> git config <span class="nt">--global</span> user.signingKey <span class="s2">"</span><span class="nv">$KeyID</span><span class="s2">!"</span><span class="p">;</span> <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"ERROR: Failed to configure git signing key"</span> <span class="o">&gt;</span>&amp;2
        <span class="k">return </span>1
    <span class="k">fi

    </span><span class="nb">echo</span> <span class="s2">"SUCCESS: Git configured to sign with key </span><span class="nv">$KeyID</span><span class="s2">"</span>
<span class="o">}</span>
</code></pre></div></div><p><strong>Usage:</strong> Add this function to your <code class="language-plaintext highlighter-rouge">.bashrc</code> or <code class="language-plaintext highlighter-rouge">.zshrc</code>, then run <code class="language-plaintext highlighter-rouge">yk-git-key</code> whenever you switch Yubikeys.</p><blockquote><p><strong>Note:</strong> This function will need updating if you have encryption or authentication keys on the Yubikey</p></blockquote><h2 id="part-5-testing-your-setup">Part 5: Testing Your Setup</h2><p>Before relying on your Yubikey for commit signing, verify the complete workflow.</p><p><strong>Create a test signed commit:</strong></p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Enable commit signing globally (if not already set)</span>
git config <span class="nt">--global</span> commit.gpgSign <span class="nb">true</span>

<span class="c"># Create a test repository or use existing one</span>
<span class="nb">cd</span> /path/to/test-repo

<span class="c"># Make a test commit</span>
git commit <span class="nt">--allow-empty</span> <span class="nt">-S</span> <span class="nt">-m</span> <span class="s2">"Test commit signing with Yubikey"</span>

<span class="c"># You should be prompted to touch your Yubikey</span>
</code></pre></div></div><p><strong>Verify the signature:</strong></p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Show the signature in git log</span>
git log <span class="nt">--show-signature</span> <span class="nt">-1</span>

<span class="c"># Expected output should show:</span>
<span class="c"># - "Good signature from &lt;your email&gt;"</span>
<span class="c"># - Your key ID</span>
<span class="c"># - Signature details</span>
</code></pre></div></div><p><strong>Test key switching (if you have multiple Yubikeys):</strong></p><ol><li>Use the <code class="language-plaintext highlighter-rouge">yk-git-key</code> function to switch to a different Yubikey</li><li>Make another test commit</li><li>Verify the signature shows the different subkey ID</li></ol><p><strong>Troubleshooting:</strong></p><ul><li>If you don’t get a touch prompt, verify your touch policy with <code class="language-plaintext highlighter-rouge">ykman openpgp info</code></li><li>If git can’t find the key, ensure <code class="language-plaintext highlighter-rouge">gpg --card-status</code> shows your Yubikey</li><li>If signature fails, check <code class="language-plaintext highlighter-rouge">git config --global user.signingKey</code> matches your current key</li></ul><h2 id="part-6-verifying-signatures">Part 6: Verifying Signatures</h2><p>To verify GPG signatures you need to import the commiter’s public key.</p><p>Github example:</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#Just show public key details</span>
curl https://github.com/kvql.gpg | gpg <span class="nt">--show-keys</span>

curl https://github.com/kvql.gpg | gpg <span class="nt">--import</span>

<span class="c"># Show signatures in git log</span>
git log <span class="nt">--show-signature</span>

<span class="c"># Verify a specific commit</span>
git verify-commit &lt;commit <span class="nb">id</span><span class="o">&gt;</span>
</code></pre></div></div><blockquote><p><strong>Note:</strong> This github export limits the overhead for users/teammates to import your keys even if you have multiple independent primary signing keys.</p></blockquote><h2 id="part-7-yubikey-attestation-for-gpg-key">Part 7: Yubikey Attestation for GPG key</h2><p><strong>This section is optional</strong> and intended for high-security environments or those wanting to provide cryptographic proof that keys were generated on a hardware device.</p><p>Attestation allows you to prove that your signing key was generated directly on a Yubikey and is subject to its touch policy. This provides additional assurance for users with strict threat models. For most use cases, the standard commit signing configured above is sufficient.</p><p>As mentioned in this <a href="https://blog.palantir.com/how-palantir-secures-source-control-105c49079eae">Palantir blog</a>, attestation can be used to verify touch policy enforcement, adding an extra layer of validation beyond standard GPG signature verification.</p><p>Yubico documentation on the attestation contents and meaning: <a href="https://developers.yubico.com/PGP/Attestation.html">https://developers.yubico.com/PGP/Attestation.html</a></p><p>Reading the attestation data:</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">ykSerial</span><span class="o">=</span><span class="si">$(</span>ykman info | <span class="nb">awk</span> <span class="s1">'/Serial number:/ {print $3}'</span><span class="si">)</span>
<span class="c"># generate and export attestation certificate</span>
<span class="c"># attest command has a question prompt if a cert already exists and </span>
<span class="c"># therefore you can't always pipe directly from that.</span>
ykman openpgp keys attest sig -
ykman openpgp certificates <span class="nb">export </span>sig - <span class="o">&gt;</span> sig-attest-<span class="nv">$ykSerial</span>.pem

<span class="c"># parse the attestation data</span>
openssl asn1parse <span class="nt">-in</span> sig-attest.pem <span class="nt">-i</span> 

<span class="c"># first 4 char are der encoding </span>
<span class="c"># specific value use above command to get string num e.g </span>
<span class="c"># 251:d=5  hl=2 l=  10 prim:      OBJECT            :1.3.6.1.4.1.41482.5.8</span>
<span class="c"># 263:d=5  hl=2 l=   3 prim:      OCTET STRING      [HEX DUMP]:040103</span>
openssl asn1parse <span class="nt">-in</span> sig-attest.pem <span class="nt">-i</span> <span class="nt">-strparse</span> 263
</code></pre></div></div><blockquote><p><strong>Note:</strong> Verifying the attestation signature against yubico public key and the attestation values is a key next step and will be covered in a later post</p></blockquote><h2 id="summary">Summary</h2><p>This guide covers git commit signing from a slightly new perspective with multiple Yubikey and on device generated secret keys for future attestation.</p><p>Next steps is to cover the threat model on what values does commit signing bring from the developer, open-source consumer and enterprise perspective. A key area which is often incorrectly represented online is how not all siging implementations are equal and the more basic implemenations mitigate minimal risks vs the platform authentication.</p><p>Implementing a reusable workflow for attesting the signing key during PRs is also key to getting the value from the attestation certificate consistently and at scale.</p></div><div class="disqus-comments" id="disqus_thread"></div></div></div></section><footer class="footer has-background-primary-dark has-text-primary-light" data-theme="dark"> <!--Footer Button--><div class="container has-text-centered " id="backtotop"> <a class="footer-btn" onclick="window.scroll(0,0)">BACK TO TOP</a></div><!--Footer Main Section--><div><div class="columns"> <!--Name Section--><div class="column has-text-left-desktop has-text-centere-mobile"><div class="columns"><div class="column is-one-fifth-desktop is-one-fifth-fullhd is-one-quarter-tablet is-flex has-text-centered"><figure class="image is-64x64 has-text-centered"> <img class="is-rounded" src="https://solaissecurity.com/assets/images/logo.png"></figure></div><div class="column is-marginless has-text-left-desktop has-text-centere-mobile"><h3 class="has-text-weight-bold has-text-centered has-text-primary-light">Solais Security</h3><a href="https://solaissecurity.com/#about"><div class="content"><p>Solais Security is an independent security consultancy run by Kevin Quil...</p></div></a></div></div></div><!--Link Section--><div class="column"><h3 class="has-text-weight-bold has-text-centered has-text-primary-light">More Links</h3><li> <a target="_blank" href="https://solaissecurity.com/#contact">Contact Us</a></li><li> <a target="_blank" href="https://solaissecurity.com/services">Services</a></li><!--<li> <a target="_blank" href="https://solaissecurity.com/feed.xml">Subscribe via RSS</a></li>--></div><!--Blog-post Section--><div class="column"><h3 class="has-text-weight-bold has-text-centered has-text-primary-light">Recent Posts</h3><li> <a href="https://solaissecurity.com/blog/commit-signing-overview"> Commit Signing - Is it worth it?</a></li><li> <a href="https://solaissecurity.com/blog/yubikey-setup-commit-signing"> Setting Up Git Commit Signing with Multiple Yub...</a></li><li> <a href="https://solaissecurity.com/blog/seceng-part-2"> Navigating the Role of an Embedded Security Eng...</a></li></div></div></div><!--<div class="has-background-black has-text-centered has-text-white" id="credits"> <i class="far fa-copyright"></i> 2026 | <a href="https://github.com/thedevslot/WhatATheme" target="_blank" rel="noopener noreferrer">WhatATheme</a> - A Theme made with <i class="fas fa-heart has-text-danger"></i> by <a href="https://www.twitter.com/thedevslot" target="_blank" rel="noopener noreferrer">TheDevsLot</a> Powered by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a></div>--></footer></body><script> /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script></html>
